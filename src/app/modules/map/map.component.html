<div class="map-information">
  <h1><b>Map View</b></h1>
  <p>
    Filter the case studies by selecting the multiple options based on infrastrucutre and damage types as
    well as the tags present on those case studies. The locations will be loaded automatically on the map depending on the selected options.
  </p>
  <p>
    <i>Note: Some documents may not have their locations properly placed. If the case study that you are looking for doesn't 
      show on the map, the creator of said case study might have not set the locations properly.</i>
  </p>

</div>
<div class="options-container">
  <div class="option-box">
    <h1>Publication Date</h1>
    <mat-form-field>
      <mat-label>Choose a date</mat-label>
      <input matInput [matDatepicker]="picker1" [(ngModel)]="publicationDate" (dateChange)="setDirty()">
      <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
      <mat-datepicker #picker1></mat-datepicker>
    </mat-form-field>
  </div>
  <div class="option-box">
    <h1>Incident Date</h1>
    <mat-form-field>
      <mat-label>Choose a date</mat-label>
      <input matInput [matDatepicker]="picker" [(ngModel)]="incidentDate" (dateChange)="setDirty()">
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
  </div>
  <div class="option-box">
    <h1>Infrastrucutre</h1>
    <mat-form-field>
      <mat-label>Select options</mat-label>
      <mat-select [formControl]="infrastructure" multiple (selectionChange)="setDirty()">
        <mat-select-trigger>
          {{infrastructure.value ? infrastructure.value[0] : ''}}
          <span *ngIf="infrastructure.value?.length > 1" class="additional-selection">
            (+{{infrastructure.value.length - 1}} {{infrastructure.value?.length === 2 ? 'other' : 'others'}})
          </span>
        </mat-select-trigger>
        <mat-option *ngFor="let element of infrastructureList" [value]="element">{{element}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div class="option-box">
    <h1>Damage</h1>
    <mat-form-field>
      <mat-label>Select options</mat-label>
      <mat-select [formControl]="damage" multiple (selectionChange)="setDirty()">
        <mat-select-trigger>
          {{damage.value ? damage.value[0] : ''}}
          <span *ngIf="damage.value?.length > 1" class="additional-selection">
            (+{{damage.value.length - 1}} {{damage.value?.length === 2 ? 'other' : 'others'}})
          </span>
        </mat-select-trigger>
        <mat-option *ngFor="let element of damageList" [value]="element">{{element}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div class="option-box">
    <h1>Tags</h1>
    <mat-form-field>
      <mat-label>Select options</mat-label>
      <mat-select [formControl]="tags" multiple (selectionChange)="setDirty()">
        <mat-select-trigger>
          {{tags.value ? tags.value[0] : ''}}
          <span *ngIf="tags.value?.length > 1" class="additional-selection">
            (+{{tags.value.length - 1}} {{tags.value?.length === 2 ? 'other' : 'others'}})
          </span>
        </mat-select-trigger>
        <mat-option *ngFor="let element of tagsList" [value]="element">{{element}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div class="option-box">
    <h1>Language</h1>
    <mat-form-field>
      <mat-label>Select option</mat-label>
      <mat-select [formControl]="language" (selectionChange)="setDirty()">
        <mat-option *ngFor="let element of languageList" [value]="element">{{element}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div class="option-box" fxFlexAlign="center">
    <p *ngIf="!dirtyFields" style="color: red;">* Select new fields to update the map.</p>
    <p *ngIf="dirtyFields" style="color: forestgreen;">* Fields changed. Please click to update the map.</p>
    <button mat-raised-button 
      color="primary" 
      style="width: 20em;" 
      [disabled]="!dirtyFields"
      (click)="updateMap()"> 
      Update Map
    </button>
  </div>
</div>


<div class="map-container">
  <google-chart #map
    [title]="title"
    [type]="type"
    [data]="data"
    [columnNames]="columnNames"
    [options]="options"
    [width]="width"
    [height]="height"
    (select)="onSelect($event)"
    >
  </google-chart>
</div>

